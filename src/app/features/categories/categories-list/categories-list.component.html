<div class="category-list p-grid p-gap-4 p-mt-2">
    <div *ngFor="let category of categorySignal.categories()" class="p-col-12 p-mb-3">
        <p-card class="p-shadow-2">
            <ng-template pTemplate="header">
                <div class="p-d-flex p-ai-center p-jc-between">
                    <span class="text-xl font-semibold">{{ category.nombre }}</span>
                    <p-tag *ngIf="category.satisfaccion" [value]="category.satisfaccion + '/10'" [severity]="
                category.satisfaccion < 4  ? 'danger' :
                category.satisfaccion < 8  ? 'warn'    :
                'success'
              ">
                    </p-tag>
                </div>
            </ng-template>

            <!-- descripciÃ³n con margen inferior -->
            <div class="p-text-secondary p-mb-2">
                {{ category.descripcion }}
            </div>

            <ng-template pTemplate="footer">
                <div class="p-d-flex p-jc-end p-gap-2">
                    <button pButton icon="pi pi-pencil" class="p-button-rounded p-button-text"
                        (click)="openEditModal(category)">
                    </button>
                    <button pButton icon="pi pi-trash" class="p-button-rounded p-button-text p-button-danger"
                        (click)="confirmDelete(category)">
                    </button>
                </div>
            </ng-template>
        </p-card>
    </div>
</div>

<!-- ðŸ“ Modal de ediciÃ³n -->
<p-dialog [visible]="editingCategory !== null" (onHide)="closeEditModal()" header="Editar CategorÃ­a" [modal]="true"
    [closable]="false" [style]="{ width: '400px' }">
    <form class="p-fluid">
        <!-- Nombre -->
        <div class="p-field p-mb-3">
            <label for="name">Nombre</label>
            <input id="name" name="editName" pInputText [(ngModel)]="editName"
                placeholder="Ingresa el nombre de la categorÃ­a" />
        </div>

        <!-- DescripciÃ³n -->
        <div class="p-field p-mb-3">
            <label for="desc">DescripciÃ³n</label>
            <textarea id="desc" name="editDescription" pInputTextarea [(ngModel)]="editDescription" rows="4"
                placeholder="Describe brevemente esta categorÃ­a"></textarea>
            <small class="helper-text">MÃ¡x. 200 caracteres</small>
        </div>

        <!-- SatisfacciÃ³n -->
        <div class="p-field p-mb-4">
            <label for="satisfaccion">SatisfacciÃ³n: {{ editSatisfaction }}</label>
            <p-slider id="satisfaccion" name="editSatisfaction" [(ngModel)]="editSatisfaction" [min]="1" [max]="10"
                [step]="1" styleClass="p-mt-1"></p-slider>
        </div>

        <!-- Acciones -->
        <div class="p-d-flex p-jc-end p-gap-2">
            <button pButton type="button" label="Cancelar" class="p-button-text" (click)="closeEditModal()"></button>
            <button pButton type="button" label="Guardar" class="p-button-primary" (click)="saveEdit()"></button>
        </div>
    </form>
</p-dialog>

<!-- ðŸ—‘ï¸ Modal de confirmaciÃ³n de borrado -->
<p-dialog [visible]="showDeleteConfirm" (onHide)="cancelDelete()" header="Confirmar Borrado"
    icon="pi pi-exclamation-triangle" [modal]="true" [closable]="false" [style]="{ width: '350px' }">
    <p>
        Â¿EstÃ¡s seguro de que deseas borrar
        <strong>{{ categoryToDelete?.nombre }}</strong>?
    </p>
    <div class="p-d-flex p-jc-end p-mt-3 p-gap-2">
        <button pButton label="Cancelar" class="p-button-text" (click)="cancelDelete()"></button>
        <button pButton label="SÃ­, borrar" class="p-button-danger" (click)="deleteCategory()"></button>
    </div>
</p-dialog>