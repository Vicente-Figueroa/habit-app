<div class="daily-habits">
    <h3>H√°bitos de Hoy</h3>

    <div *ngFor="let category of ['diario', 'semanal', 'mensual', 'ocasional']">
        <h4 *ngIf="groupedHabits[category]?.length">
            <span *ngIf="category === 'diario'">üìÖ</span>
            <span *ngIf="category === 'semanal'">üóìÔ∏è</span>
            <span *ngIf="category === 'mensual'">üìÜ</span>
            <span *ngIf="category === 'ocasional'">üéØ</span>
            {{ category | titlecase }}
        </h4>

        <div class="habits-grid" *ngIf="groupedHabits[category]?.length">
            <ng-container *ngFor="let habit of groupedHabits[category]">
                <div *ngIf="!(habit.tipo === 'bueno' && getProgress(habit) >= habit.objetivo)" class="habit-card">
                    <div class="card-header">
                        <h4 [ngStyle]="{'color': habit.tipo==='bueno' ? '#4caf50' : '#f44336'}">
                            <i class="fas"
                                [ngClass]="{'fa-smile': habit.tipo==='bueno', 'fa-frown': habit.tipo==='malo'}"
                                [ngStyle]="{'color': habit.tipo==='bueno' ? '#4caf50' : '#f44336'}"></i>
                            {{ habit.nombre }}
                        </h4>
                    </div>
                    <div class="card-body">
                        <p *ngIf="habit.descripcion" class="description">{{ habit.descripcion }}</p>
                        <p class="meta">
                            <i class="fas fa-bullseye"></i>
                            <strong>Meta:</strong> {{ habit.objetivo }} {{ habit.unidadObjetivo }} - {{ habit.frecuencia
                            }}
                        </p>
                        <ng-container [ngSwitch]="habit.tipo">
                            <p *ngSwitchCase="'bueno'" class="progress">
                                <i class="fas fa-chart-line" [style.color]="getProgressColor(habit)"></i>
                                Progreso: <span [style.color]="getProgressColor(habit)">{{ getProgress(habit) }}</span>
                                / {{
                                habit.objetivo }}
                            </p>
                            <p *ngSwitchCase="'malo'" class="incidences">
                                <i class="fas fa-exclamation-triangle" [style.color]="getProgressColor(habit)"></i>
                                Incidencias: <span [style.color]="getProgressColor(habit)">{{ getProgress(habit)
                                    }}</span>
                            </p>
                        </ng-container>
                    </div>
                    <div class="card-actions">
                        <button (click)="registerQuickLog(habit)" class="quick-log-btn">
                            <i class="fas fa-plus-circle"></i>
                            Registro R√°pido
                        </button>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>

    <div *ngIf="completedGoodHabits.length">
        <h4>H√°bitos Completados ‚úÖ</h4>
        <div class="habits-grid">
            <div *ngFor="let habit of completedGoodHabits" class="habit-card completed">
                <div class="card-header">
                    <h4 [ngStyle]="{'color': '#4caf50'}">
                        <i class="fas fa-check-circle" [ngStyle]="{'color': '#4caf50'}"></i>
                        {{ habit.nombre }}
                    </h4>
                </div>
                <div class="card-body">
                    <p *ngIf="habit.descripcion" class="description">{{ habit.descripcion }}</p>
                    <p class="meta">
                        <i class="fas fa-bullseye"></i>
                        <strong>Meta Alcanzada:</strong> {{ habit.objetivo }} {{ habit.unidadObjetivo }}
                    </p>
                    <p class="progress">
                        <i class="fas fa-chart-line" style="color: #4caf50"></i>
                        Progreso: <span style="color: #4caf50">{{ getProgress(habit) }}</span> / {{ habit.objetivo }}
                    </p>
                </div>
                <div class="card-actions">
                    <button (click)="registerQuickLog(habit)" class="quick-log-btn">
                        <i class="fas fa-plus-circle"></i>
                        A√±adir M√°s Registro
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>